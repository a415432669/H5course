<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>HTML5Course - 梦幻雪冰</title>
	<style>
		.wrap img {
			width: 200px;
		}
	</style>
</head>
<body>
	<div class="wrap">
		<img src="images/1.JPG" alt="" title="">
		<img src="images/2.JPG" alt="" title="">
		<img src="images/3.JPG" alt="" title="">
		<img src="images/4.JPG" alt="" title="">
		<img src="images/5.JPG" alt="" title="">
	</div>
	<script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
	<script type="text/javascript">
		$.extend({
			loadImageState: function($images, successFn) {
				// 存储Deferred对象
				var dfdArr = [];

				// 遍历网页中所有的图片
				$images.each(function() {
					// 创建Deferred对象
					var dfd = $.Deferred();

					// 改变Deferred对象的执行状态——已完成
					$(this).load(function() {
						dfd.resolve();
					})

					dfdArr.push(dfd);
				});

				// 如果都成功了，就运行done()指定的回调函数；如果有一个失败或都失败了，就执行fail()指定的回调函数。
				// 使用了apply来接受数组参数
				$.when.apply(null, dfdArr).then(successFn);
			}
		});
		
		$.loadImageState($('img'), function() {
			console.log('全部加载完成');
		});
	</script>
</body>
</html>